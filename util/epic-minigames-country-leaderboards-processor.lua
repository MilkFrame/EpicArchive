local old = {} --insert latest revision here
local new = old --insert updated revision here if updating leaderboards, else declare 'old'

local countryNames={["MS"]={["Name"]="Montserrat",["Emoji"]="ğŸ‡²ğŸ‡¸"},["FK"]={["Name"]="FalklandIslands",["Emoji"]="ğŸ‡«ğŸ‡°"},["CC"]={["Name"]="Cocos(Keeling)Islands",["Emoji"]="ğŸ‡¨ğŸ‡¨"},["HK"]={["Name"]="HongKongSARChina",["Emoji"]="ğŸ‡­ğŸ‡°"},["EC"]={["Name"]="Ecuador",["Emoji"]="ğŸ‡ªğŸ‡¨"},["PS"]={["Name"]="PalestinianTerritories",["Emoji"]="ğŸ‡µğŸ‡¸"},["MK"]={["Name"]="Macedonia",["Emoji"]="ğŸ‡²ğŸ‡°"},["RS"]={["Name"]="Serbia",["Emoji"]="ğŸ‡·ğŸ‡¸"},["US"]={["Emoji"]="ğŸ‡ºğŸ‡¸",["Name"]="UnitedStates",["Language"]="English"},["WS"]={["Name"]="Samoa",["Emoji"]="ğŸ‡¼ğŸ‡¸"},["CK"]={["Name"]="CookIslands",["Emoji"]="ğŸ‡¨ğŸ‡°"},["LC"]={["Name"]="St.Lucia",["Emoji"]="ğŸ‡±ğŸ‡¨"},["DK"]={["Name"]="Denmark",["Emoji"]="ğŸ‡©ğŸ‡°"},["SC"]={["Name"]="Seychelles",["Emoji"]="ğŸ‡¸ğŸ‡¨"},["AS"]={["Name"]="AmericanSamoa",["Emoji"]="ğŸ‡¦ğŸ‡¸"},["TC"]={["Name"]="Turks & CaicosIslands",["Emoji"]="ğŸ‡¹ğŸ‡¨"},["VC"]={["Name"]="St.Vincent & Grenadines",["Emoji"]="ğŸ‡»ğŸ‡¨"},["ES"]={["Emoji"]="ğŸ‡ªğŸ‡¸",["Name"]="Spain",["Language"]="Spanish"},["VI"]={["Name"]="U.S.VirginIslands",["Emoji"]="ğŸ‡»ğŸ‡®"},["GS"]={["Name"]="SouthGeorgia & SouthSandwichIslands",["Emoji"]="ğŸ‡¬ğŸ‡¸"},["PK"]={["Name"]="Pakistan",["Emoji"]="ğŸ‡µğŸ‡°"},["IS"]={["Name"]="Iceland",["Emoji"]="ğŸ‡®ğŸ‡¸"},["PW"]={["Name"]="Palau",["Emoji"]="ğŸ‡µğŸ‡¼"},["BS"]={["Name"]="Bahamas",["Emoji"]="ğŸ‡§ğŸ‡¸"},["TK"]={["Name"]="Tokelau",["Emoji"]="ğŸ‡¹ğŸ‡°"},["NP"]={["Name"]="Nepal",["Emoji"]="ğŸ‡³ğŸ‡µ"},["CO"]={["Name"]="Colombia",["Emoji"]="ğŸ‡¨ğŸ‡´"},["VN"]={["Emoji"]="ğŸ‡»ğŸ‡³",["Name"]="Vietnam",["Language"]="Vietnamese"},["GH"]={["Name"]="Ghana",["Emoji"]="ğŸ‡¬ğŸ‡­"},["LA"]={["Name"]="Laos",["Emoji"]="ğŸ‡±ğŸ‡¦"},["MH"]={["Name"]="MarshallIslands",["Emoji"]="ğŸ‡²ğŸ‡­"},["KM"]={["Name"]="Comoros",["Emoji"]="ğŸ‡°ğŸ‡²"},["KH"]={["Name"]="Cambodia",["Emoji"]="ğŸ‡°ğŸ‡­"},["SX"]={["Name"]="SintMaarten",["Emoji"]="ğŸ‡¸ğŸ‡½"},["MX"]={["Name"]="Mexico",["Emoji"]="ğŸ‡²ğŸ‡½"},["LS"]={["Name"]="Lesotho",["Emoji"]="ğŸ‡±ğŸ‡¸"},["AG"]={["Name"]="Antigua & Barbuda",["Emoji"]="ğŸ‡¦ğŸ‡¬"},["BE"]={["Name"]="Belgium",["Emoji"]="ğŸ‡§ğŸ‡ª"},["EH"]={["Name"]="WesternSahara",["Emoji"]="ğŸ‡ªğŸ‡­"},["BH"]={["Name"]="Bahrain",["Emoji"]="ğŸ‡§ğŸ‡­"},["CH"]={["Name"]="Switzerland",["Emoji"]="ğŸ‡¨ğŸ‡­"},["IR"]={["Name"]="Iran",["Emoji"]="ğŸ‡®ğŸ‡·"},["SY"]={["Name"]="Syria",["Emoji"]="ğŸ‡¸ğŸ‡¾"},["SS"]={["Name"]="SouthSudan",["Emoji"]="ğŸ‡¸ğŸ‡¸"},["CX"]={["Name"]="ChristmasIsland",["Emoji"]="ğŸ‡¨ğŸ‡½"},["LK"]={["Name"]="SriLanka",["Emoji"]="ğŸ‡±ğŸ‡°"},["SI"]={["Name"]="Slovenia",["Emoji"]="ğŸ‡¸ğŸ‡®"},["PA"]={["Name"]="Panama",["Emoji"]="ğŸ‡µğŸ‡¦"},["GF"]={["Name"]="FrenchGuiana",["Emoji"]="ğŸ‡¬ğŸ‡«"},["PH"]={["Emoji"]="ğŸ‡µğŸ‡­",["Name"]="Philippines",["Language"]="Tagalog"},["GP"]={["Name"]="Guadeloupe",["Emoji"]="ğŸ‡¬ğŸ‡µ"},["NC"]={["Name"]="NewCaledonia",["Emoji"]="ğŸ‡³ğŸ‡¨"},["NG"]={["Name"]="Nigeria",["Emoji"]="ğŸ‡³ğŸ‡¬"},["TH"]={["Emoji"]="ğŸ‡¹ğŸ‡­",["Name"]="Thailand",["Language"]="Thai"},["AX"]={["Name"]="Ã…landIslands",["Emoji"]="ğŸ‡¦ğŸ‡½"},["AQ"]={["Name"]="Antarctica",["Emoji"]="ğŸ‡¦ğŸ‡¶"},["SH"]={["Name"]="St.Helena",["Emoji"]="ğŸ‡¸ğŸ‡­"},["UY"]={["Name"]="Uruguay",["Emoji"]="ğŸ‡ºğŸ‡¾"},["BA"]={["Name"]="Bosnia & Herzegovina",["Emoji"]="ğŸ‡§ğŸ‡¦"},["MQ"]={["Name"]="Martinique",["Emoji"]="ğŸ‡²ğŸ‡¶"},["FI"]={["Name"]="Finland",["Emoji"]="ğŸ‡«ğŸ‡®"},["GA"]={["Name"]="Gabon",["Emoji"]="ğŸ‡¬ğŸ‡¦"},["LI"]={["Name"]="Liechtenstein",["Emoji"]="ğŸ‡±ğŸ‡®"},["KI"]={["Name"]="Kiribati",["Emoji"]="ğŸ‡°ğŸ‡®"},["NZ"]={["Name"]="NewZealand",["Emoji"]="ğŸ‡³ğŸ‡¿"},["MY"]={["Name"]="Malaysia",["Emoji"]="ğŸ‡²ğŸ‡¾"},["LY"]={["Name"]="Libya",["Emoji"]="ğŸ‡±ğŸ‡¾"},["KY"]={["Name"]="CaymanIslands",["Emoji"]="ğŸ‡°ğŸ‡¾"},["MC"]={["Name"]="Monaco",["Emoji"]="ğŸ‡²ğŸ‡¨"},["CA"]={["Emoji"]="ğŸ‡¨ğŸ‡¦",["Name"]="Canada",["Language"]="English"},["NA"]={["Name"]="Namibia",["Emoji"]="ğŸ‡³ğŸ‡¦"},["CI"]={["Name"]="CÃ´tedâ€™Ivoire",["Emoji"]="ğŸ‡¨ğŸ‡®"},["BI"]={["Name"]="Burundi",["Emoji"]="ğŸ‡§ğŸ‡®"},["SA"]={["Name"]="SaudiArabia",["Emoji"]="ğŸ‡¸ğŸ‡¦"},["LB"]={["Name"]="Lebanon",["Emoji"]="ğŸ‡±ğŸ‡§"},["QA"]={["Name"]="Qatar",["Emoji"]="ğŸ‡¶ğŸ‡¦"},["BY"]={["Name"]="Belarus",["Emoji"]="ğŸ‡§ğŸ‡¾"},["CD"]={["Name"]="Congo-Kinshasa",["Emoji"]="ğŸ‡¨ğŸ‡©"},["BQ"]={["Name"]="CaribbeanNetherlands",["Emoji"]="ğŸ‡§ğŸ‡¶"},["UA"]={["Name"]="Ukraine",["Emoji"]="ğŸ‡ºğŸ‡¦"},["AO"]={["Name"]="Angola",["Emoji"]="ğŸ‡¦ğŸ‡´"},["GQ"]={["Name"]="EquatorialGuinea",["Emoji"]="ğŸ‡¬ğŸ‡¶"},["ZA"]={["Name"]="SouthAfrica",["Emoji"]="ğŸ‡¿ğŸ‡¦"},["VA"]={["Name"]="VaticanCity",["Emoji"]="ğŸ‡»ğŸ‡¦"},["NI"]={["Name"]="Nicaragua",["Emoji"]="ğŸ‡³ğŸ‡®"},["GL"]={["Name"]="Greenland",["Emoji"]="ğŸ‡¬ğŸ‡±"},["MP"]={["Name"]="NorthernMarianaIslands",["Emoji"]="ğŸ‡²ğŸ‡µ"},["IQ"]={["Name"]="Iraq",["Emoji"]="ğŸ‡®ğŸ‡¶"},["VU"]={["Name"]="Vanuatu",["Emoji"]="ğŸ‡»ğŸ‡º"},["IN"]={["Name"]="India",["Emoji"]="ğŸ‡®ğŸ‡³"},["AZ"]={["Name"]="Azerbaijan",["Emoji"]="ğŸ‡¦ğŸ‡¿"},["KN"]={["Name"]="St.Kitts & Nevis",["Emoji"]="ğŸ‡°ğŸ‡³"},["JM"]={["Name"]="Jamaica",["Emoji"]="ğŸ‡¯ğŸ‡²"},["JP"]={["Emoji"]="ğŸ‡¯ğŸ‡µ",["Name"]="Japan",["Language"]="Japanese"},["LV"]={["Name"]="Latvia",["Emoji"]="ğŸ‡±ğŸ‡»"},["AF"]={["Name"]="Afghanistan",["Emoji"]="ğŸ‡¦ğŸ‡«"},["BF"]={["Name"]="BurkinaFaso",["Emoji"]="ğŸ‡§ğŸ‡«"},["MN"]={["Name"]="Mongolia",["Emoji"]="ğŸ‡²ğŸ‡³"},["BN"]={["Name"]="Brunei",["Emoji"]="ğŸ‡§ğŸ‡³"},["CN"]={["Name"]="China",["Emoji"]="ğŸ‡¨ğŸ‡³"},["NF"]={["Name"]="NorfolkIsland",["Emoji"]="ğŸ‡³ğŸ‡«"},["SV"]={["Name"]="ElSalvador",["Emoji"]="ğŸ‡¸ğŸ‡»"},["TV"]={["Name"]="Tuvalu",["Emoji"]="ğŸ‡¹ğŸ‡»"},["NR"]={["Name"]="Nauru",["Emoji"]="ğŸ‡³ğŸ‡·"},["PY"]={["Name"]="Paraguay",["Emoji"]="ğŸ‡µğŸ‡¾"},["IT"]={["Name"]="Italy",["Emoji"]="ğŸ‡®ğŸ‡¹"},["TF"]={["Name"]="FrenchSouthernTerritories",["Emoji"]="ğŸ‡¹ğŸ‡«"},["MV"]={["Name"]="Maldives",["Emoji"]="ğŸ‡²ğŸ‡»"},["BV"]={["Name"]="BouvetIsland",["Emoji"]="ğŸ‡§ğŸ‡»"},["SK"]={["Name"]="Slovakia",["Emoji"]="ğŸ‡¸ğŸ‡°"},["PF"]={["Name"]="FrenchPolynesia",["Emoji"]="ğŸ‡µğŸ‡«"},["GM"]={["Name"]="Gambia",["Emoji"]="ğŸ‡¬ğŸ‡²"},["FM"]={["Name"]="Micronesia",["Emoji"]="ğŸ‡«ğŸ‡²"},["CL"]={["Name"]="Chile",["Emoji"]="ğŸ‡¨ğŸ‡±"},["MT"]={["Name"]="Malta",["Emoji"]="ğŸ‡²ğŸ‡¹"},["SN"]={["Name"]="Senegal",["Emoji"]="ğŸ‡¸ğŸ‡³"},["TN"]={["Name"]="Tunisia",["Emoji"]="ğŸ‡¹ğŸ‡³"},["CV"]={["Name"]="CapeVerde",["Emoji"]="ğŸ‡¨ğŸ‡»"},["CF"]={["Name"]="CentralAfricanRepublic",["Emoji"]="ğŸ‡¨ğŸ‡«"},["GI"]={["Name"]="Gibraltar",["Emoji"]="ğŸ‡¬ğŸ‡®"},["PN"]={["Name"]="PitcairnIslands",["Emoji"]="ğŸ‡µğŸ‡³"},["JO"]={["Name"]="Jordan",["Emoji"]="ğŸ‡¯ğŸ‡´"},["CG"]={["Name"]="Congo-Brazzaville",["Emoji"]="ğŸ‡¨ğŸ‡¬"},["RW"]={["Name"]="Rwanda",["Emoji"]="ğŸ‡·ğŸ‡¼"},["EG"]={["Name"]="Egypt",["Emoji"]="ğŸ‡ªğŸ‡¬"},["FO"]={["Name"]="FaroeIslands",["Emoji"]="ğŸ‡«ğŸ‡´"},["KW"]={["Name"]="Kuwait",["Emoji"]="ğŸ‡°ğŸ‡¼"},["BG"]={["Name"]="Bulgaria",["Emoji"]="ğŸ‡§ğŸ‡¬"},["MW"]={["Name"]="Malawi",["Emoji"]="ğŸ‡²ğŸ‡¼"},["BO"]={["Name"]="Bolivia",["Emoji"]="ğŸ‡§ğŸ‡´"},["KG"]={["Name"]="Kyrgyzstan",["Emoji"]="ğŸ‡°ğŸ‡¬"},["DO"]={["Name"]="DominicanRepublic",["Emoji"]="ğŸ‡©ğŸ‡´"},["MG"]={["Name"]="Madagascar",["Emoji"]="ğŸ‡²ğŸ‡¬"},["TW"]={["Name"]="Taiwan",["Emoji"]="ğŸ‡¹ğŸ‡¼"},["GG"]={["Name"]="Guernsey",["Emoji"]="ğŸ‡¬ğŸ‡¬"},["YT"]={["Name"]="Mayotte",["Emoji"]="ğŸ‡¾ğŸ‡¹"},["ME"]={["Name"]="Montenegro",["Emoji"]="ğŸ‡²ğŸ‡ª"},["TG"]={["Name"]="Togo",["Emoji"]="ğŸ‡¹ğŸ‡¬"},["SG"]={["Name"]="Singapore",["Emoji"]="ğŸ‡¸ğŸ‡¬"},["VG"]={["Name"]="BritishVirginIslands",["Emoji"]="ğŸ‡»ğŸ‡¬"},["UG"]={["Name"]="Uganda",["Emoji"]="ğŸ‡ºğŸ‡¬"},["PG"]={["Name"]="PapuaNewGuinea",["Emoji"]="ğŸ‡µğŸ‡¬"},["GB"]={["Name"]="UnitedKingdom",["Emoji"]="ğŸ‡¬ğŸ‡§"},["GN"]={["Name"]="Guinea",["Emoji"]="ğŸ‡¬ğŸ‡³"},["KP"]={["Emoji"]="ğŸ‡°ğŸ‡µ",["Name"]="NorthKorea",["Language"]="Korean"},["RO"]={["Name"]="Romania",["Emoji"]="ğŸ‡·ğŸ‡´"},["GW"]={["Name"]="Guinea-Bissau",["Emoji"]="ğŸ‡¬ğŸ‡¼"},["TO"]={["Name"]="Tonga",["Emoji"]="ğŸ‡¹ğŸ‡´"},["SO"]={["Name"]="Somalia",["Emoji"]="ğŸ‡¸ğŸ‡´"},["NO"]={["Name"]="Norway",["Emoji"]="ğŸ‡³ğŸ‡´"},["MO"]={["Name"]="MacauSARChina",["Emoji"]="ğŸ‡²ğŸ‡´"},["AE"]={["Name"]="UnitedArabEmirates",["Emoji"]="ğŸ‡¦ğŸ‡ª"},["MF"]={["Name"]="St.Martin",["Emoji"]="ğŸ‡²ğŸ‡«"},["GY"]={["Name"]="Guyana",["Emoji"]="ğŸ‡¬ğŸ‡¾"},["WF"]={["Name"]="Wallis & Futuna",["Emoji"]="ğŸ‡¼ğŸ‡«"},["IL"]={["Name"]="Israel",["Emoji"]="ğŸ‡®ğŸ‡±"},["PT"]={["Emoji"]="ğŸ‡µğŸ‡¹",["Name"]="Portugal",["Language"]="Portuguese"},["AD"]={["Name"]="Andorra",["Emoji"]="ğŸ‡¦ğŸ‡©"},["BD"]={["Name"]="Bangladesh",["Emoji"]="ğŸ‡§ğŸ‡©"},["MA"]={["Name"]="Morocco",["Emoji"]="ğŸ‡²ğŸ‡¦"},["LT"]={["Name"]="Lithuania",["Emoji"]="ğŸ‡±ğŸ‡¹"},["MD"]={["Name"]="Moldova",["Emoji"]="ğŸ‡²ğŸ‡©"},["GD"]={["Name"]="Grenada",["Emoji"]="ğŸ‡¬ğŸ‡©"},["AL"]={["Name"]="Albania",["Emoji"]="ğŸ‡¦ğŸ‡±"},["BL"]={["Name"]="St.BarthÃ©lemy",["Emoji"]="ğŸ‡§ğŸ‡±"},["ID"]={["Name"]="Indonesia",["Emoji"]="ğŸ‡®ğŸ‡©"},["HN"]={["Name"]="Honduras",["Emoji"]="ğŸ‡­ğŸ‡³"},["ST"]={["Name"]="SÃ£oTomÃ© & PrÃ­ncipe",["Emoji"]="ğŸ‡¸ğŸ‡¹"},["TT"]={["Name"]="Trinidad & Tobago",["Emoji"]="ğŸ‡¹ğŸ‡¹"},["AT"]={["Name"]="Austria",["Emoji"]="ğŸ‡¦ğŸ‡¹"},["BT"]={["Name"]="Bhutan",["Emoji"]="ğŸ‡§ğŸ‡¹"},["SD"]={["Name"]="Sudan",["Emoji"]="ğŸ‡¸ğŸ‡©"},["TD"]={["Name"]="Chad",["Emoji"]="ğŸ‡¹ğŸ‡©"},["CW"]={["Name"]="CuraÃ§ao",["Emoji"]="ğŸ‡¨ğŸ‡¼"},["LR"]={["Name"]="Liberia",["Emoji"]="ğŸ‡±ğŸ‡·"},["CU"]={["Name"]="Cuba",["Emoji"]="ğŸ‡¨ğŸ‡º"},["ZW"]={["Name"]="Zimbabwe",["Emoji"]="ğŸ‡¿ğŸ‡¼"},["SL"]={["Name"]="SierraLeone",["Emoji"]="ğŸ‡¸ğŸ‡±"},["TL"]={["Name"]="Timor-Leste",["Emoji"]="ğŸ‡¹ğŸ‡±"},["GT"]={["Name"]="Guatemala",["Emoji"]="ğŸ‡¬ğŸ‡¹"},["HT"]={["Name"]="Haiti",["Emoji"]="ğŸ‡­ğŸ‡¹"},["ET"]={["Name"]="Ethiopia",["Emoji"]="ğŸ‡ªğŸ‡¹"},["PL"]={["Name"]="Poland",["Emoji"]="ğŸ‡µğŸ‡±"},["ML"]={["Name"]="Mali",["Emoji"]="ğŸ‡²ğŸ‡±"},["NL"]={["Name"]="Netherlands",["Emoji"]="ğŸ‡³ğŸ‡±"},["RU"]={["Name"]="Russia",["Emoji"]="ğŸ‡·ğŸ‡º"},["EE"]={["Name"]="Estonia",["Emoji"]="ğŸ‡ªğŸ‡ª"},["DE"]={["Name"]="Germany",["Emoji"]="ğŸ‡©ğŸ‡ª"},["IM"]={["Name"]="IsleofMan",["Emoji"]="ğŸ‡®ğŸ‡²"},["HM"]={["Name"]="Heard & McDonaldIslands",["Emoji"]="ğŸ‡­ğŸ‡²"},["MU"]={["Name"]="Mauritius",["Emoji"]="ğŸ‡²ğŸ‡º"},["LU"]={["Name"]="Luxembourg",["Emoji"]="ğŸ‡±ğŸ‡º"},["TZ"]={["Name"]="Tanzania",["Emoji"]="ğŸ‡¹ğŸ‡¿"},["NE"]={["Name"]="Niger",["Emoji"]="ğŸ‡³ğŸ‡ª"},["CM"]={["Name"]="Cameroon",["Emoji"]="ğŸ‡¨ğŸ‡²"},["BM"]={["Name"]="Bermuda",["Emoji"]="ğŸ‡§ğŸ‡²"},["KE"]={["Name"]="Kenya",["Emoji"]="ğŸ‡°ğŸ‡ª"},["JE"]={["Name"]="Jersey",["Emoji"]="ğŸ‡¯ğŸ‡ª"},["IE"]={["Name"]="Ireland",["Emoji"]="ğŸ‡®ğŸ‡ª"},["AM"]={["Name"]="Armenia",["Emoji"]="ğŸ‡¦ğŸ‡²"},["GE"]={["Name"]="Georgia",["Emoji"]="ğŸ‡¬ğŸ‡ª"},["VE"]={["Name"]="Venezuela",["Emoji"]="ğŸ‡»ğŸ‡ª"},["AU"]={["Name"]="Australia",["Emoji"]="ğŸ‡¦ğŸ‡º"},["ZM"]={["Name"]="Zambia",["Emoji"]="ğŸ‡¿ğŸ‡²"},["SE"]={["Name"]="Sweden",["Emoji"]="ğŸ‡¸ğŸ‡ª"},["RE"]={["Name"]="RÃ©union",["Emoji"]="ğŸ‡·ğŸ‡ª"},["AI"]={["Name"]="Anguilla",["Emoji"]="ğŸ‡¦ğŸ‡®"},["PE"]={["Name"]="Peru",["Emoji"]="ğŸ‡µğŸ‡ª"},["UM"]={["Name"]="U.S.OutlyingIslands",["Emoji"]="ğŸ‡ºğŸ‡²"},["TM"]={["Name"]="Turkmenistan",["Emoji"]="ğŸ‡¹ğŸ‡²"},["SM"]={["Name"]="SanMarino",["Emoji"]="ğŸ‡¸ğŸ‡²"},["HU"]={["Name"]="Hungary",["Emoji"]="ğŸ‡­ğŸ‡º"},["GU"]={["Name"]="Guam",["Emoji"]="ğŸ‡¬ğŸ‡º"},["PM"]={["Name"]="St.Pierre & Miquelon",["Emoji"]="ğŸ‡µğŸ‡²"},["OM"]={["Name"]="Oman",["Emoji"]="ğŸ‡´ğŸ‡²"},["CY"]={["Name"]="Cyprus",["Emoji"]="ğŸ‡¨ğŸ‡¾"},["MM"]={["Name"]="Myanmar(Burma)",["Emoji"]="ğŸ‡²ğŸ‡²"},["FJ"]={["Name"]="Fiji",["Emoji"]="ğŸ‡«ğŸ‡¯"},["MR"]={["Name"]="Mauritania",["Emoji"]="ğŸ‡²ğŸ‡·"},["BB"]={["Name"]="Barbados",["Emoji"]="ğŸ‡§ğŸ‡§"},["UZ"]={["Name"]="Uzbekistan",["Emoji"]="ğŸ‡ºğŸ‡¿"},["PR"]={["Name"]="PuertoRico",["Emoji"]="ğŸ‡µğŸ‡·"},["IO"]={["Name"]="BritishIndianOceanTerritory",["Emoji"]="ğŸ‡®ğŸ‡´"},["NU"]={["Name"]="Niue",["Emoji"]="ğŸ‡³ğŸ‡º"},["SR"]={["Name"]="Suriname",["Emoji"]="ğŸ‡¸ğŸ‡·"},["TR"]={["Name"]="Turkey",["Emoji"]="ğŸ‡¹ğŸ‡·"},["KZ"]={["Name"]="Kazakhstan",["Emoji"]="ğŸ‡°ğŸ‡¿"},["YE"]={["Name"]="Yemen",["Emoji"]="ğŸ‡¾ğŸ‡ª"},["MZ"]={["Name"]="Mozambique",["Emoji"]="ğŸ‡²ğŸ‡¿"},["BJ"]={["Name"]="Benin",["Emoji"]="ğŸ‡§ğŸ‡¯"},["AW"]={["Name"]="Aruba",["Emoji"]="ğŸ‡¦ğŸ‡¼"},["DJ"]={["Name"]="Djibouti",["Emoji"]="ğŸ‡©ğŸ‡¯"},["SZ"]={["Name"]="Swaziland",["Emoji"]="ğŸ‡¸ğŸ‡¿"},["BZ"]={["Name"]="Belize",["Emoji"]="ğŸ‡§ğŸ‡¿"},["CZ"]={["Name"]="Czechia",["Emoji"]="ğŸ‡¨ğŸ‡¿"},["DZ"]={["Name"]="Algeria",["Emoji"]="ğŸ‡©ğŸ‡¿"},["SB"]={["Name"]="SolomonIslands",["Emoji"]="ğŸ‡¸ğŸ‡§"},["BW"]={["Name"]="Botswana",["Emoji"]="ğŸ‡§ğŸ‡¼"},["AR"]={["Name"]="Argentina",["Emoji"]="ğŸ‡¦ğŸ‡·"},["BR"]={["Emoji"]="ğŸ‡§ğŸ‡·",["Name"]="Brazil",["Language"]="Portuguese"},["CR"]={["Name"]="CostaRica",["Emoji"]="ğŸ‡¨ğŸ‡·"},["DM"]={["Name"]="Dominica",["Emoji"]="ğŸ‡©ğŸ‡²"},["ER"]={["Name"]="Eritrea",["Emoji"]="ğŸ‡ªğŸ‡·"},["FR"]={["Name"]="France",["Emoji"]="ğŸ‡«ğŸ‡·"},["GR"]={["Name"]="Greece",["Emoji"]="ğŸ‡¬ğŸ‡·"},["HR"]={["Name"]="Croatia",["Emoji"]="ğŸ‡­ğŸ‡·"},["SJ"]={["Name"]="Svalbard & JanMayen",["Emoji"]="ğŸ‡¸ğŸ‡¯"},["TJ"]={["Name"]="Tajikistan",["Emoji"]="ğŸ‡¹ğŸ‡¯"},["KR"]={["Emoji"]="ğŸ‡°ğŸ‡·",["Name"]="SouthKorea",["Language"]="Korean"},["XK"]={["Name"]="Kosovo"}}
local function formatTimestamp(timestamp)
    local date = os.date("*t", timestamp)
    return string.format("%04d-%02d-%02d %02d:%02d", date.year, date.month, date.day, date.hour, date.min)
end

-- Function to print the database as an Excel-like tab-separated format
local function printSpreadsheet(database)
    -- Collect the keys and sort them alphabetically
    local keys = {}
    for key, _ in pairs(database) do
        table.insert(keys, key)
    end
    table.sort(keys)

    -- Print the header row (two-letter keys, each spanning 3 columns)
    local header = {}
    local lastupdated = {}
    local players = {}
    for _, key in ipairs(keys) do
        local entry = database[key]
        table.insert(header, countryNames[key].Name.." ["..key.."]\t\t\t")
        table.insert(lastupdated, "Last updated: " .. formatTimestamp(entry.lastupdated) .. "\t\t\t")
        
        -- Print players' information for this key
        for i = 1, 100 do
            local player = entry.players[i]
            if player then
                table.insert(players, string.format("%d%s\t%s\t%d", player[1], key, player[2], player[3]))
            else
                table.insert(players, "\t\t\t")
            end
        end
    end
    
    -- Print header line (first line)
    print(table.concat(header))
    
    -- Print last updated line (second line)
    print(table.concat(lastupdated))
    
    -- Print players' information (next 100 lines)
    for i = 1, 100 do
        local row = {}
        for _, key in ipairs(keys) do
            local entry = database[key]
            local player = entry.players[i]
            if player then
                table.insert(row, string.format("%d\t%s\t%d\t", player[1], player[2], player[3]))
            else
                table.insert(row, "\t\t\t")
            end
        end
        print(table.concat(row))
    end
end
local function printCSV(database)
    -- Collect the keys and sort them alphabetically
    local keys = {}
    for key, _ in pairs(database) do
        table.insert(keys, key)
    end
    table.sort(keys)

    -- Print the header row (two-letter keys, each spanning 3 columns)
    local header = {}
    local lastupdated = {}
    local players = {}
    for _, key in ipairs(keys) do
        local entry = database[key]
        table.insert(header, " ,"..countryNames[key].Name.." ["..key.."],,")
        table.insert(lastupdated, ",Last updated: " .. formatTimestamp(entry.lastupdated) .. ",,")
        
        -- Print players' information for this key
        for i = 1, 100 do
            local player = entry.players[i]
            if player then
                table.insert(players, string.format("%d%s,%s,%d", player[1], key, player[2], player[3]))
            else
                table.insert(players, ",,,")
            end
        end
    end
    
    -- Print header line (first line)
    print(table.concat(header))
    
    -- Print last updated line (second line)
    print(table.concat(lastupdated))
    
    -- Print players' information (next 100 lines)
    for i = 1, 100 do
        local row = {}
        for _, key in ipairs(keys) do
            local entry = database[key]
            local player = entry.players[i]
            if player then
                table.insert(row, string.format("%d,%s,%d,", player[1], player[2], player[3]))
            else
                table.insert(row, ",,,")
            end
        end
        print(table.concat(row))
    end
end
function printJSON(database)
  local JSON = "{\n"
  local keys = {}
    for key, _ in pairs(database) do
        table.insert(keys, key)
    end
    table.sort(keys)

    for _, key in ipairs(keys) do
        JSON = JSON .. "\""..key.."\":{\"players\":["
        local entry = database[key]
        for i = 1, 100 do
            local player = entry.players[i]
            if player and player[3] > 0 then
                JSON = JSON .. "["..player[1]..",\""..player[2].."\","..player[3].."],"
            end
        end
        JSON = JSON:sub(1,JSON:len()-1).."],\"lastupdated\":"..database[key].lastupdated.."},\n"
    end
    JSON = JSON:sub(1,JSON:len()-2).."\n}"
    print(JSON)
end

function compareEntries(old_entry, new_entry, key)
    -- Function to count the number of "Player" entries in the players subtable
    local function countPlayers(entry)
        local playerCount = 0
        for _, player in ipairs(entry["players"]) do
            if player[2] == "Player" then
                playerCount = playerCount + 1
            end
        end
        return playerCount
    end
    
    -- Get the player counts for both old and new entries
    local oldPlayerCount = countPlayers(old_entry)
    local newPlayerCount = countPlayers(new_entry)
    
    -- Print the difference in "Player" counts if they are different
    if oldPlayerCount ~= newPlayerCount then
        print(string.format("Key: %s - Player count difference: %d", key, oldPlayerCount-newPlayerCount))
    else
        --print(string.format("Key: %s - No difference", key))
    end
    
    if oldPlayerCount < newPlayerCount then
        return old_entry
    end
    -- Return the entry with the higher lastupdated value
    if old_entry["lastupdated"] > new_entry["lastupdated"] then
        return old_entry
    else
        print(key.." updated:",math.floor((new_entry["lastupdated"]-old_entry["lastupdated"])/3600).."h")
        return new_entry
    end
end

c3=0 new_countries={} local toPrint=true
function compareDatabases(old_database,new_database)
  local combined = {}
  for i,v in pairs(old_database) do
    if new_database[i] ~= nil then
      local compare = compareEntries(v,new[i],i)
      combined[i] = compare
    else
      combined[i] = v
    end
  end
  for i, v in pairs(new_database) do
    if old_database[i] == nil then
      combined[i] = v
    end
  end
  combined["country"]=nil
  for i,v in pairs(combined) do
    c3=c3+1
    if old_database[i]==nil then table.insert(new_countries,countryNames[i].Name.." ["..i.."]") end
  end
  
  p="{" countries={}
  for i,v in pairs(combined) do table.insert(countries,{i,v}) end
  table.sort(countries,function(a,b) return a[1]<b[1] end)
  for i,v in pairs(countries) do
  p=p.."[\""..v[1].."\"]={[\"players\"]={"
  for rank= 1,100 do
  local plr=v[2].players[rank]
  p=p.."{"..rank..",\""..plr[2].."\","..plr[3].."},"
  end
  p=p.."},[\"lastupdated\"]="..v[2].lastupdated.."},\n"
  end
  p=p.."}"
  if toPrint==true then print(p) end
  return combined
end

---Actions below:

toPrint=true --set to FALSE if only need to print spreadsheet
local newDatabase = compareDatabases(old,new)
--printSpreadsheet(newDatabase)
--printCSV(newDatabase)
--printJSON(newDatabase)

--LATEST REVISION: EM_countries1734789867.915b3

c1=0 for i,v in pairs(old) do c1=c1+1 end print("old count:",c1)
c2=0 for i,v in pairs(new) do c2=c2+1 end print("new count:",c2)
print("union count:",c3)
for i,v in pairs(new_countries) do print("new country: "..v) end
